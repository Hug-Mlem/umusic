{"version":3,"sources":["pages/auth/SignUp.js"],"names":["Button","styled","MuiButton","spacing","Wrapper","Paper","props","theme","breakpoints","up","CssTextField","TextField","color","borderBottomColor","borderColor","INITIAL_STATE","username","email","passwordOne","passwordTwo","error","SignUpForm","storeUserData","fetch","then","response","ok","json","Error","data","userInfo","uid","firebase","auth","currentUser","state","firestore","collection","add","address","city","country","country_name","region","uf","deleted","createdAt","Date","toLocaleString","console","log","catch","e","source","action","dateTime","browser","ip","latitude","longitude","currency","user","onSubmit","event","doCreateUserWithEmailAndPassword","authUser","set","setState","history","push","preventDefault","onChange","target","name","value","this","isInvalid","style","textAlign","marginBottom","src","require","width","fontSize","fontWeight","fontFamily","margin","required","fullWidth","id","label","variant","placeholder","autoComplete","autoFocus","type","disabled","mt","marginTop","component","Link","to","message","Component","SignUp","compose","withRouter","withFirebase"],"mappings":"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","file":"static/js/15.b17a5eb2.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport { Link, withRouter } from \"react-router-dom\";\n\nimport { withFirebase } from \"../../Firebase\";\nimport { compose } from \"recompose\";\n\nimport {\n  FormControl,\n  Button as MuiButton,\n  Paper,\n  TextField,\n} from \"@material-ui/core\";\nimport { spacing } from \"@material-ui/system\";\nimport './style.css';\nconst Button = styled(MuiButton)(spacing);\n\nconst Wrapper = styled(Paper)`\n  padding: ${props => props.theme.spacing(6)}px;\n\n  ${props => props.theme.breakpoints.up(\"md\")} {\n    padding: ${props => props.theme.spacing(10)}px;\n  }\n`;\n\n\n\nconst CssTextField = styled(TextField)({\n  '& label.Mui-focused': {\n    color: '#F3903F',\n  },\n  '& .MuiInput-underline:after': {\n    borderBottomColor: '#F3903F',\n  },\n  '& .MuiOutlinedInput-root': {\n    '& fieldset': {\n      borderColor: '#F3903F',\n    },\n    '&:hover fieldset': {\n      borderColor: '#F3903F',\n    },\n    '&.Mui-focused fieldset': {\n      borderColor: '#F3903F',\n    },\n  },\n});\n\nconst INITIAL_STATE = {\n  username: \"\",\n  email: \"\",\n  passwordOne: \"\",\n  passwordTwo: \"\",\n  error: null\n};\n\nconst API = 'https://ipapi.co/json/';\n\nclass SignUpForm extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { ...INITIAL_STATE };\n  }\n\n\n  storeUserData = () => {\n    // get Ip address\n    fetch(API)\n      .then(response => {\n        if (response.ok) {\n          return response.json();\n        } else {\n          throw new Error('Something went wrong ...');\n        }\n      })\n      .then(data => {\n        var userInfo = {\n          uid: this.props.firebase.auth.currentUser.uid,\n          email: this.state.email\n        };\n        // this.props.firebase.db.ref('logs').push({ \n        //save to users\n        this.props.firebase.firestore.collection('users').add({\n          uid: this.props.firebase.auth.currentUser.uid,\n          email: this.state.email,\n          address: {\n            city: data.city,\n            country: data.country_name,\n            region: data.region,\n            uf: ''\n          },\n          deleted: false,\n          createdAt: new Date().toLocaleString()\n        }).then(() => {\n          console.log('Signup users is saved to logs!');\n        }).catch((e) => {\n          console.log('Signup users Failed.', e);\n        });\n\n        console.log('after access the add user', this.props.firebase.auth.currentUser.uid, this.state.email, data)\n        // save to logs\n        this.props.firebase.firestore.collection('logs').add({\n          source: 'Web',\n          action: 'signup',\n          dateTime: new Date().toLocaleString(),\n          browser: this.props.firebase.browser,\n          ip: data.ip,\n          latitude: data.latitude,\n          longitude: data.longitude,\n          country: data.country_name,\n          city: data.city,\n          currency: data.currency,\n          user: userInfo\n        }).then(() => {\n          console.log('Signup logs is saved to logs!');\n        }).catch((e) => {\n          console.log('Signup Failed.', e);\n        });\n      })\n      .catch(error => console.log('error'));\n\n  }\n\n  onSubmit = event => {\n    const { username, email, passwordOne } = this.state;\n\n    this.props.firebase\n      .doCreateUserWithEmailAndPassword(email, passwordOne)\n      .then(authUser => {\n        // Create a user in your Firebase realtime database\n        return this.props.firebase.user(authUser.user.uid).set({\n          username,\n          email\n        });\n\n      })\n      .then(() => {\n        this.setState({ ...INITIAL_STATE });\n        this.storeUserData()\n        console.log('success store signup log')\n        this.props.history.push('/');\n      })\n      .catch(error => {\n        this.setState({ error });\n      });\n\n    event.preventDefault();\n  };\n\n  onChange = event => {\n    this.setState({ [event.target.name]: event.target.value });\n  };\n\n  render() {\n    const { username, email, passwordOne, passwordTwo, error } = this.state;\n\n    const isInvalid =\n      passwordOne !== passwordTwo ||\n      passwordOne === \"\" ||\n      email === \"\" ||\n      username === \"\";\n\n    return (\n      <Wrapper>\n        <div style={{ textAlign: 'center', marginBottom: '30px' }}>\n          <img src={require('../../assets/logo.jpg')} style={{ width: '50px' }} />\n        </div>\n        <p style={{ textAlign: 'center', fontSize: '50px', fontWeight: 700, fontFamily: 'Inter, Rubik, sans-serif' }}>\n          Đăng ký\n        </p>\n\n        <form onSubmit={this.onSubmit}>\n          <FormControl margin=\"normal\" required fullWidth>\n            <CssTextField id=\"username\"\n              name=\"username\"\n              label=\"Họ và tên\"\n              variant=\"outlined\"\n              placeholder=\"Họ và tên\"\n              value={username}\n              onChange={this.onChange}\n              autoComplete=\"username\"\n              autoFocus />\n\n\n          </FormControl>\n          <FormControl margin=\"normal\" required fullWidth>\n            <CssTextField id=\"email\"\n              name=\"email\"\n              label=\"Email\"\n              variant=\"outlined\"\n              placeholder=\"Email\"\n              value={email}\n              onChange={this.onChange}\n              autoComplete=\"email\"\n              autoFocus />\n\n          </FormControl>\n          <FormControl margin=\"normal\" required fullWidth>\n            <CssTextField name=\"passwordOne\"\n              type=\"password\"\n              id=\"passwordOne\"\n              label=\"Password\"\n              variant=\"outlined\"\n              placeholder=\"Password\"\n              value={passwordOne}\n              onChange={this.onChange}\n              autoComplete=\"password\"\n              autoFocus />\n          </FormControl>\n          <FormControl margin=\"normal\" required fullWidth>\n            <CssTextField name=\"passwordTwo\"\n              type=\"password\"\n              id=\"passwordTwo\"\n              label=\"Nhập lại mật khẩu\"\n              variant=\"outlined\"\n              placeholder=\"Nhập lại mật khẩu\"\n              value={passwordTwo}\n              onChange={this.onChange}\n            />\n\n          </FormControl>\n          <Button\n            disabled={isInvalid}\n            type=\"submit\"\n            fullWidth\n            variant=\"contained\"\n            color=\"primary\"\n            mt={2}\n          >\n            Đồng ý\n          </Button>\n          <div style={{ textAlign: 'center', marginTop: '30px' }}>\n\n            <Button\n              component={Link}\n              to=\"/sign-in\"\n              color=\"primary\"\n            >\n              &lt;\n            </Button>\n          </div>\n          {error && <p style={{ color: 'red' }}>{error.message}</p>}\n        </form>\n      </Wrapper>\n    );\n  }\n}\n\n// export default SignUp;\nconst SignUp = compose(\n  withRouter,\n  withFirebase\n)(SignUpForm);\n\nexport default SignUp;\n"],"sourceRoot":""}